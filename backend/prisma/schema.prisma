datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id          Int     @default(autoincrement()) @id
  email       String? @unique
  username    String  @unique
  password	  String
  avatar      String?
  userStatus  String  @default("Offline") // online | in-game | offline
  Game		  Game[]  @relation("Game")
  stats		  Stats?
  createdAt   DateTime @default(now())
  updatedAt	  DateTime @updatedAt
}

model Stats {
	User	User @relation(fields: [userId], references: [id])
	userId 	Int
	matchesPlayed Int @default(0)
	wins	Int @default(0)
	losses	Int @default(0)
	rank 	String @default("Iron") // Bronze, Silver, Gold, Emerald, Diamond, Master, Challenger
	createdAt DateTime @default(now())
	updatedAt DateTime @updatedAt

	@@id([userId])
}

enum GameStatus {
	MATCHMAKING
	INVITE
	ONGOING
	FINISHED
}

enum GameType {
	CLASSIC
	MEDIUM
	HARDCORE
}

model Game {
	id		Int @id @default(autoincrement())
	
	outcome String? @default("Undefined") // Win | Loss

	p1Score	Int		@default(0)
	p2Score	Int 	@default(0)

	p2Id	Int

	gameType GameType
	gameStatus GameStatus

	createdAt DateTime @default(now())
	updatedAt DateTime @updatedAt

	user	User @relation("Game", fields: [userId], references: [id])
	userId Int
}